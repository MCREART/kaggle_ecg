experiment:
  name: grid_5class_run
  seed: 2025
  output_dir: ./runs

data:
  train_dirs:
    - ../../dataset_grid_wave_mix
  val_split: 0.1
  batch_size: 32
  num_workers: 32
  augment: true
  in_channels: 3
  # 0: BG, 1: H-Line, 2: V-Line, 3: Intersection, 4: Wave
  classes: 5

optim:
  type: adamw
  lr: 0.001
  weight_decay: 0.0001

training:
  epochs: 50
  log_interval: 25
  amp: true
  grad_clip: 1.0

loss:
  type: ce
  # Weights strategy: 
  # Intersection (3) is rare -> high weight (100.0)
  # Wave (4) is critical -> moderate-high weight (50.0)
  # H/V (1,2) are structural -> boosted weight (10.0)
  weights: [1.0, 10.0, 10.0, 100.0, 50.0]

models:
  - key: unet_efficientnetb0
    encoder_weights: imagenet
    in_channels: 3
    classes: 5
